<script>
function generate() {
  if (points.length < 3) return;

  const workW = Number(document.getElementById("width").value);
  const poly = turf.polygon([[...points, points[0]]]);
  const bbox = turf.bbox(poly);

  let y = bbox[1];
  let lines = [];

  // --- collect each working line ---
  while (y <= bbox[3]) {
    const scan = turf.lineString([[bbox[0] - 10, y], [bbox[2] + 10, y]]);
    const hits = turf.lineIntersect(scan, poly);

    if (hits.features.length >= 2) {
      // sort intersections by X (left -> right)
      const pts = hits.features
        .map(f => f.geometry.coordinates)
        .sort((a, b) => a[0] - b[0]);

      lines.push({
        left: pts</html>
