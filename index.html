import matplotlib.pyplot as plt

# ===== 圃場設定 =====
FIELD_WIDTH = 100    # 横幅（m）
FIELD_HEIGHT = 60    # 縦幅（m）
WORK_WIDTH = 5       # トラクター作業幅（m）
HEADLAND_WIDTH = 8   # 枕地幅（m）

# ===== 経路格納 =====
path_x = []
path_y = []

def add_point(x, y):
    path_x.append(x)
    path_y.append(y)

# ===== 1. 内側耕起エリア設定（枕地を除外） =====
inner_x_min = HEADLAND_WIDTH
inner_x_max = FIELD_WIDTH - HEADLAND_WIDTH
inner_y_min = HEADLAND_WIDTH
inner_y_max = FIELD_HEIGHT - HEADLAND_WIDTH

# ===== 2. 内側往復耕起（平行ライン） =====
y = inner_y_min
direction = 1  # 1: → , -1: ←

while y <= inner_y_max:
    if direction == 1:
        # 左 → 右
        add_point(inner_x_min, y)
        add_point(inner_x_max, y)
    else:
        # 右 → 左
        add_point(inner_x_max, y)
        add_point(inner_x_min, y)

    y += WORK_WIDTH
    direction *= -1

# ===== 3. 枕地（3分耕起）最後に周回 =====
# 下辺 → 右辺 → 上辺（左辺は出入口想定で除外）

# 下辺
add_point(HEADLAND_WIDTH, HEADLAND_WIDTH)
add_point(FIELD_WIDTH - HEADLAND_WIDTH, HEADLAND_WIDTH)

# 右辺
add_point(FIELD_WIDTH - HEADLAND_WIDTH, HEADLAND_WIDTH)
add_point(FIELD_WIDTH - HEADLAND_WIDTH, FIELD_HEIGHT - HEADLAND_WIDTH)

# 上辺
add_point(FIELD_WIDTH - HEADLAND_WIDTH, FIELD_HEIGHT - HEADLAND_WIDTH)
add_point(HEADLAND_WIDTH, FIELD_HEIGHT - HEADLAND_WIDTH)

# ===== 描画 =====
plt.figure(figsize=(12, 7))

# 圃場外枠
plt.plot(
    [0, FIELD_WIDTH, FIELD_WIDTH, 0, 0],
    [0, 0, FIELD_HEIGHT, FIELD_HEIGHT, 0],
    'k-', linewidth=2, label="圃場外枠"
)

# 枕地エリア枠
plt.plot(
    [HEADLAND_WIDTH, FIELD_WIDTH-HEADLAND_WIDTH, FIELD_WIDTH-HEADLAND_WIDTH, HEADLAND_WIDTH, HEADLAND_WIDTH],
    [HEADLAND_WIDTH, HEADLAND_WIDTH, FIELD_HEIGHT-HEADLAND_WIDTH, FIELD_HEIGHT-HEADLAND_WIDTH, HEADLAND_WIDTH],
    'r--', linewidth=1.5, label="内側耕起エリア"
)

# 走行経路
plt.plot(path_x, path_y, 'b-', linewidth=2, label="トラクター走行ライン")

# 開始点
plt.plot(path_x[0], path_y[0], 'go', markersize=8, label="開始点")

# 終了点
plt.plot(path_x[-1], path_y[-1], 'ro', markersize=8, label="終了点")

# 表示設定
plt.title("枕地3分後回し方式 トラクター耕起経路図")
plt.xlabel("X座標 (m)")
plt.ylabel("Y座標 (m)")
plt.axis("equal")
plt.grid(True)
plt.legend()
plt.show()
